# Домашнее задание 8. Программирование на Python (1 курс, 2025/2026)
## Тема 9. Взаимодействие в WWW: взаимодействие с сервисами

### Анализ HTTP‑трафика с помощью Scapy и эксплуатация XSS в Google Gruyere

#### 1. Введение
В рамках работы была изучена библиотека Scapy, выполнена настройка перехвата HTTP‑трафика, проведён анализ взаимодействия с веб‑приложением Google Gruyere, а также осуществлена эксплуатация XSS‑уязвимостей.
Цель работы — понять, как выглядит HTTP‑трафик при обычной работе и при атаке, а также выявить и продемонстрировать XSS‑уязвимости.

#### 2. Настройка Scapy
**2.1. Перехват HTTP‑трафика**
Для перехвата HTTP‑запросов и ответов был создан скрипт `sniff_http.py`.
Скрипт выводит HTTP‑заголовки и тело запросов/ответов.

**2.2. Отправка HTTP‑запроса через Scapy**
Для отправки HTTP‑запроса был создан скрипт `send_http.py`.

#### 3. Анализ трафика Google Gruyere
Для анализа использовалась онлайн‑версия Gruyere:
https://google-gruyere.appspot.com/

Во время взаимодействия с сайтом (регистрация, создание постов, просмотр страниц) Scapy фиксировал:
- HTTP GET запросы;
- HTTP POST запросы;
- Cookie;
- HTML‑ответы сервера.

#### 4. Эксплуатация XSS
**4.1. Поиск точек входа**
В ходе анализа были найдены следующие потенциальные точки XSS:
- поле “New Snippet”;
- поле “Profile”;
- комментарии;
- параметр `?msg=...`.

**4.2. Payload**
Использовались стандартные XSS‑вставки:

```
<script>alert('XSS')</script>
```
и
```
<img src=x onerror="alert('XSS')">
```

**4.3. Результат**
При вставке payload в поле “New Snippet” он отобразился на странице без фильтрации, что привело к выполнению JavaScript.

#### 5. Анализ трафика XSS‑атаки
В трафике Scapy видно:

Запрос:
POST /newpost HTTP/1.1
body=<script>alert('XSS')</script>
Ответ:
HTTP/1.1 200 OK
...
<script>alert('XSS')</script>
Изменения в трафике:
В запросе появился вредоносный payload

Сервер вернул его без фильтрации

В ответе содержится JavaScript, который выполняется в браузере

#### 6. Выводы
Приложение уязвимо к XSS

Пользовательский ввод не фильтруется

Сервер отражает данные напрямую в HTML

Scapy позволяет увидеть XSS‑payload в запросах и ответах

#### 7. Рекомендации
Экранировать HTML‑символы (<, >, ", ')

Использовать безопасные шаблонизаторы

Включить Content Security Policy

Проверять и очищать пользовательский ввод

Файлы проекта:
sniff_http.py — перехват HTTP

send_http.py — отправка HTTP

README.md — отчёт
